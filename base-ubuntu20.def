Bootstrap: docker
From: ubuntu:20.04

%help
This is a base Ubuntu 20.04 setup
With Intel OneAPI

%labels
Author Charles Peterson <charles.c.peterson3@gmail.com>

%post
export DEBIAN_FRONTEND=noninteractive
export APT_KEY_DONT_WARN_ON_DANGEROUS_USAGE=1
export SINGULARITY_SHELL=/bin/bash
export SHELL=/bin/bash
apt-get update \
&& apt-get -y upgrade \
&& apt-get install -y  gfortran g++  make ssh patch curl subversion wget unzip perl git file python3 python3-dev gnupg2 software-properties-common \
&& cd /tmp  \
&& wget https://apt.repos.intel.com/intel-gpg-keys/GPG-PUB-KEY-INTEL-SW-PRODUCTS-2023.PUB \
&& apt-key add GPG-PUB-KEY-INTEL-SW-PRODUCTS-2023.PUB  \
&& rm GPG-PUB-KEY-INTEL-SW-PRODUCTS-2023.PUB  \
&& echo "deb https://apt.repos.intel.com/oneapi all main" | tee /etc/apt/sources.list.d/oneAPI.list \
&& add-apt-repository "deb https://apt.repos.intel.com/oneapi all main" \
&& apt-get update \
&& apt install -y  intel-basekit intel-hpckit intel-aikit

echo '. /opt/intel/oneapi/setvars.sh' >>$SINGULARITY_ENVIRONMENT 


%runscript
exec /bin/bash "$@"


